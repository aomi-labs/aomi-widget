{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "control-bar",
  "type": "registry:component",
  "description": "Control bar with model/namespace selectors, API key input, and wallet connect.",
  "files": [
    {
      "type": "registry:component",
      "path": "components/control-bar/index.tsx",
      "content": "\"use client\";\n\nimport type { ReactNode, FC } from \"react\";\nimport { cn } from \"@aomi-labs/react\";\nimport { ModelSelect } from \"./model-select\";\nimport { NamespaceSelect } from \"./namespace-select\";\nimport { ApiKeyInput } from \"./api-key-input\";\nimport { WalletConnect } from \"./wallet-connect\";\n\n// =============================================================================\n// Types\n// =============================================================================\n\nexport type ControlBarProps = {\n  className?: string;\n  /** Custom controls to render alongside built-in ones */\n  children?: ReactNode;\n  /** Hide the model selector */\n  hideModel?: boolean;\n  /** Hide the namespace/agent selector */\n  hideNamespace?: boolean;\n  /** Hide the API key input */\n  hideApiKey?: boolean;\n  /** Hide the wallet connect button (default: true) */\n  hideWallet?: boolean;\n};\n\n// =============================================================================\n// Main Component\n// =============================================================================\n\nexport const ControlBar: FC<ControlBarProps> = ({\n  className,\n  children,\n  hideModel = false,\n  hideNamespace = false,\n  hideApiKey = false,\n  hideWallet = true,\n}) => {\n  return (\n    <div className={cn(\"flex items-center gap-2\", className)}>\n      {!hideModel && <ModelSelect />}\n      {!hideNamespace && <NamespaceSelect />}\n      {!hideWallet && <WalletConnect />}\n      {children}\n      {!hideApiKey && <ApiKeyInput />}\n    </div>\n  );\n};\n\n// =============================================================================\n// Re-exports for granular usage\n// =============================================================================\n\nexport { ModelSelect, type ModelSelectProps } from \"./model-select\";\nexport { NamespaceSelect, type NamespaceSelectProps } from \"./namespace-select\";\nexport { ApiKeyInput, type ApiKeyInputProps } from \"./api-key-input\";\nexport { WalletConnect, type WalletConnectProps } from \"./wallet-connect\";\n"
    },
    {
      "type": "registry:component",
      "path": "components/control-bar/model-select.tsx",
      "content": "\"use client\";\n\nimport { useEffect, useState, type FC } from \"react\";\nimport { ChevronDownIcon, CheckIcon } from \"lucide-react\";\nimport { useControl, cn } from \"@aomi-labs/react\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\n\nexport type ModelSelectProps = {\n  className?: string;\n  placeholder?: string;\n};\n\nexport const ModelSelect: FC<ModelSelectProps> = ({\n  className,\n  placeholder = \"Select model\",\n}) => {\n  const {\n    state,\n    getAvailableModels,\n    getCurrentThreadControl,\n    onModelSelect,\n    isProcessing,\n  } = useControl();\n  const [open, setOpen] = useState(false);\n\n  // Fetch available models on mount\n  useEffect(() => {\n    void getAvailableModels();\n  }, [getAvailableModels]);\n\n  // Get current thread's selected model (or fall back to default)\n  const threadControl = getCurrentThreadControl();\n  const selectedModel =\n    threadControl.model ?? state.defaultModel ?? state.availableModels[0];\n\n  const models = state.availableModels.length > 0 ? state.availableModels : [];\n\n  // Don't render if no models available\n  if (models.length === 0) {\n    return (\n      <Button\n        variant=\"ghost\"\n        disabled\n        className={cn(\n          \"h-8 w-auto min-w-[100px] rounded-full px-2 text-xs\",\n          \"text-muted-foreground\",\n          className,\n        )}\n      >\n        <span className=\"truncate\">Loading...</span>\n      </Button>\n    );\n  }\n\n  return (\n    <Popover open={open} onOpenChange={setOpen}>\n      <PopoverTrigger asChild>\n        <Button\n          variant=\"ghost\"\n          role=\"combobox\"\n          aria-expanded={open}\n          disabled={isProcessing}\n          className={cn(\n            \"h-8 w-auto min-w-[100px] justify-between rounded-full px-2 text-xs\",\n            \"text-muted-foreground hover:bg-accent hover:text-accent-foreground\",\n            isProcessing && \"cursor-not-allowed opacity-50\",\n            className,\n          )}\n        >\n          <span className=\"truncate\">{selectedModel || placeholder}</span>\n          <ChevronDownIcon className=\"ml-2 h-4 w-4 shrink-0 opacity-50\" />\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent\n        align=\"center\"\n        sideOffset={-40}\n        className=\"w-[220px] rounded-3xl p-1 shadow-none\"\n      >\n        <div className=\"flex flex-col gap-0.5\">\n          {models.map((model) => (\n            <button\n              key={model}\n              disabled={isProcessing}\n              onClick={() => {\n                console.log(\"[ModelSelect] clicked\", { model, isProcessing });\n                if (isProcessing) return;\n                setOpen(false);\n                console.log(\"[ModelSelect] calling onModelSelect\", { model });\n                void onModelSelect(model)\n                  .then(() => {\n                    console.log(\"[ModelSelect] onModelSelect completed\", {\n                      model,\n                    });\n                  })\n                  .catch((err) => {\n                    console.error(\"[ModelSelect] onModelSelect failed:\", err);\n                  });\n              }}\n              className={cn(\n                \"flex w-full items-center justify-between gap-2 rounded-full px-3 py-2 text-sm outline-none\",\n                \"hover:bg-accent hover:text-accent-foreground\",\n                \"focus:bg-accent focus:text-accent-foreground\",\n                selectedModel === model && \"bg-accent\",\n                isProcessing && \"cursor-not-allowed opacity-50\",\n              )}\n            >\n              <span>{model}</span>\n              {selectedModel === model && <CheckIcon className=\"h-4 w-4\" />}\n            </button>\n          ))}\n        </div>\n      </PopoverContent>\n    </Popover>\n  );\n};\n"
    },
    {
      "type": "registry:component",
      "path": "components/control-bar/namespace-select.tsx",
      "content": "\"use client\";\n\nimport { useState, useEffect, type FC } from \"react\";\nimport { ChevronDownIcon, CheckIcon } from \"lucide-react\";\nimport { useControl, cn } from \"@aomi-labs/react\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\n\nexport type NamespaceSelectProps = {\n  className?: string;\n  placeholder?: string;\n};\n\nexport const NamespaceSelect: FC<NamespaceSelectProps> = ({\n  className,\n  placeholder = \"Select agent\",\n}) => {\n  const {\n    state,\n    getAuthorizedNamespaces,\n    getCurrentThreadControl,\n    onNamespaceSelect,\n    isProcessing,\n  } = useControl();\n  const [open, setOpen] = useState(false);\n\n  // Fetch authorized namespaces on mount\n  useEffect(() => {\n    void getAuthorizedNamespaces();\n  }, [getAuthorizedNamespaces]);\n\n  // Get current thread's selected namespace (or fall back to default)\n  const threadControl = getCurrentThreadControl();\n  const selectedNamespace =\n    threadControl.namespace ?? state.defaultNamespace ?? \"default\";\n\n  const namespaces = state.authorizedNamespaces;\n\n  // Show loading state if no namespaces yet\n  if (namespaces.length === 0) {\n    return (\n      <Button\n        variant=\"ghost\"\n        disabled\n        className={cn(\n          \"h-8 w-auto min-w-[100px] rounded-full px-2 text-xs\",\n          \"text-muted-foreground\",\n          className,\n        )}\n      >\n        <span className=\"truncate\">{selectedNamespace}</span>\n      </Button>\n    );\n  }\n\n  return (\n    <Popover open={open} onOpenChange={setOpen}>\n      <PopoverTrigger asChild>\n        <Button\n          variant=\"ghost\"\n          role=\"combobox\"\n          aria-expanded={open}\n          disabled={isProcessing}\n          className={cn(\n            \"h-8 w-auto min-w-[100px] justify-between rounded-full px-3 text-xs\",\n            \"text-muted-foreground hover:bg-accent hover:text-accent-foreground\",\n            isProcessing && \"cursor-not-allowed opacity-50\",\n            className,\n          )}\n        >\n          <span className=\"truncate\">{selectedNamespace ?? placeholder}</span>\n          <ChevronDownIcon className=\"ml-2 h-4 w-4 shrink-0 opacity-50\" />\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent\n        align=\"center\"\n        sideOffset={-40}\n        className=\"w-[180px] rounded-3xl p-1 shadow-none\"\n      >\n        <div className=\"flex flex-col gap-0.5\">\n          {namespaces.map((ns: string) => (\n            <button\n              key={ns}\n              disabled={isProcessing}\n              onClick={() => {\n                console.log(\"[NamespaceSelect] clicked\", { ns, isProcessing });\n                if (isProcessing) return;\n                console.log(\"[NamespaceSelect] calling onNamespaceSelect\", {\n                  ns,\n                });\n                onNamespaceSelect(ns);\n                setOpen(false);\n                console.log(\"[NamespaceSelect] onNamespaceSelect completed\", {\n                  ns,\n                });\n              }}\n              className={cn(\n                \"flex w-full items-center justify-between gap-2 rounded-full px-3 py-2 text-sm outline-none\",\n                \"hover:bg-accent hover:text-accent-foreground\",\n                \"focus:bg-accent focus:text-accent-foreground\",\n                selectedNamespace === ns && \"bg-accent\",\n                isProcessing && \"cursor-not-allowed opacity-50\",\n              )}\n            >\n              <span>{ns}</span>\n              {selectedNamespace === ns && <CheckIcon className=\"h-4 w-4\" />}\n            </button>\n          ))}\n        </div>\n      </PopoverContent>\n    </Popover>\n  );\n};\n"
    },
    {
      "type": "registry:component",
      "path": "components/control-bar/api-key-input.tsx",
      "content": "\"use client\";\n\nimport { useState, type FC } from \"react\";\nimport { KeyIcon, CheckIcon, EyeIcon, EyeOffIcon } from \"lucide-react\";\nimport { useControl, cn } from \"@aomi-labs/react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\n\nexport type ApiKeyInputProps = {\n  className?: string;\n  title?: string;\n  description?: string;\n};\n\nexport const ApiKeyInput: FC<ApiKeyInputProps> = ({\n  className,\n  title = \"Aomi API Key\",\n  description = \"Enter your API key to authenticate with Aomi services.\",\n}) => {\n  const { state, setState } = useControl();\n  const [open, setOpen] = useState(false);\n  const [inputValue, setInputValue] = useState(\"\");\n  const [showKey, setShowKey] = useState(false);\n\n  const hasApiKey = Boolean(state.apiKey);\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <DialogTrigger asChild>\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          className={cn(\"relative rounded-full\", className)}\n          aria-label={hasApiKey ? \"API key configured\" : \"Set API key\"}\n        >\n          <KeyIcon className={cn(\"h-4 w-4\", hasApiKey && \"text-green-500\")} />\n        </Button>\n      </DialogTrigger>\n      <DialogContent className=\"max-w-[280px] rounded-3xl pl-4\">\n        <DialogHeader className=\"border-0\">\n          <DialogTitle>{title}</DialogTitle>\n          <DialogDescription>{description}</DialogDescription>\n        </DialogHeader>\n        <div className=\"grid gap-4 py-4\">\n          <div className=\"grid gap-2\">\n            <Label htmlFor=\"api-key\" className=\"mb-2\">\n              API Key\n            </Label>\n            <div className=\"relative\">\n              <Input\n                id=\"api-key\"\n                type={showKey ? \"text\" : \"password\"}\n                placeholder={hasApiKey ? \"********\" : \"Enter your API key\"}\n                value={inputValue}\n                onChange={(e) => setInputValue(e.target.value)}\n                className=\"rounded-full pr-10\"\n              />\n              <Button\n                type=\"button\"\n                variant=\"ghost\"\n                size=\"icon\"\n                className=\"absolute right-0 top-0 h-full px-3 hover:bg-transparent\"\n                onClick={() => setShowKey(!showKey)}\n                aria-label={showKey ? \"Hide API key\" : \"Show API key\"}\n              >\n                {showKey ? (\n                  <EyeIcon className=\"h-4 w-4\" />\n                ) : (\n                  <EyeOffIcon className=\"h-4 w-4\" />\n                )}\n              </Button>\n            </div>\n            {hasApiKey && (\n              <p className=\"text-muted-foreground text-xs\">\n                <CheckIcon className=\"mr-1 inline h-3 w-3 text-green-500\" />\n                API key is configured\n              </p>\n            )}\n          </div>\n        </div>\n        <DialogFooter>\n          {hasApiKey && (\n            <Button\n              variant=\"outline\"\n              className=\"rounded-full\"\n              onClick={() => {\n                setState({ apiKey: null });\n                setInputValue(\"\");\n              }}\n            >\n              Clear\n            </Button>\n          )}\n          <Button\n            className=\"rounded-full\"\n            onClick={() => {\n              if (inputValue.trim()) {\n                setState({ apiKey: inputValue.trim() });\n                setOpen(false);\n                setInputValue(\"\");\n              }\n            }}\n            disabled={!inputValue.trim()}\n          >\n            Save\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n};\n"
    },
    {
      "type": "registry:component",
      "path": "components/control-bar/wallet-connect.tsx",
      "content": "\"use client\";\n\nimport { useEffect, type FC } from \"react\";\nimport { useAccount, useConnect, useDisconnect } from \"wagmi\";\nimport { cn, formatAddress, getNetworkName, useUser } from \"@aomi-labs/react\";\n\nexport type WalletConnectProps = {\n  className?: string;\n  connectLabel?: string;\n  onConnectionChange?: (connected: boolean) => void;\n};\n\nexport const WalletConnect: FC<WalletConnectProps> = ({\n  className,\n  connectLabel = \"Connect Wallet\",\n  onConnectionChange,\n}) => {\n  const { address, isConnected, chainId } = useAccount();\n  const { connect, connectors } = useConnect();\n  const { disconnect } = useDisconnect();\n  const { setUser } = useUser();\n\n  // Sync wallet state to UserContext\n  useEffect(() => {\n    setUser({\n      address: address ?? undefined,\n      chainId: chainId ?? undefined,\n      isConnected,\n    });\n    onConnectionChange?.(isConnected);\n  }, [address, chainId, isConnected, setUser, onConnectionChange]);\n\n  const handleClick = () => {\n    if (isConnected) {\n      disconnect();\n    } else {\n      const connector = connectors[0];\n      if (connector) {\n        connect({ connector });\n      }\n    }\n  };\n\n  const networkName = getNetworkName(chainId);\n\n  return (\n    <button\n      type=\"button\"\n      onClick={handleClick}\n      className={cn(\n        \"inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium\",\n        \"rounded-full px-5 py-2.5\",\n        \"bg-neutral-900 text-white\",\n        \"hover:bg-neutral-800\",\n        \"dark:bg-neutral-900 dark:text-white\",\n        \"dark:hover:bg-neutral-800\",\n        \"transition-colors\",\n        \"focus-visible:ring-ring focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2\",\n        \"disabled:pointer-events-none disabled:opacity-50\",\n        className,\n      )}\n      aria-label={isConnected ? \"Disconnect wallet\" : \"Connect wallet\"}\n    >\n      <span>\n        {isConnected && address ? formatAddress(address) : connectLabel}\n      </span>\n      {isConnected && networkName && (\n        <>\n          <span className=\"opacity-50\">â€¢</span>\n          <span className=\"opacity-50\">{networkName}</span>\n        </>\n      )}\n    </button>\n  );\n};\n"
    }
  ],
  "dependencies": [
    "@aomi-labs/react",
    "wagmi",
    "lucide-react"
  ],
  "registryDependencies": [
    "button",
    "popover",
    "dialog",
    "input",
    "label"
  ]
}