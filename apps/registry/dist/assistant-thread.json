{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "assistant-thread",
  "type": "registry:component",
  "description": "Chat surface built on @assistant-ui primitives.",
  "files": [
    {
      "type": "registry:component",
      "path": "components/assistant-ui/thread.tsx",
      "content": "\"use client\";\n\nimport {\n  ArrowDownIcon,\n  ArrowUpIcon,\n  CheckIcon,\n  ChevronLeftIcon,\n  ChevronRightIcon,\n  CopyIcon,\n  PencilIcon,\n  RefreshCwIcon,\n  Square,\n} from \"lucide-react\";\n\nimport {\n  ActionBarPrimitive,\n  BranchPickerPrimitive,\n  ComposerPrimitive,\n  ErrorPrimitive,\n  MessagePrimitive,\n  ThreadPrimitive,\n} from \"@assistant-ui/react\";\n\nimport type { FC } from \"react\";\nimport { useEffect } from \"react\";\nimport { LazyMotion, MotionConfig, domAnimation } from \"motion/react\";\nimport * as m from \"motion/react-m\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { MarkdownText } from \"@/components/assistant-ui/markdown-text\";\nimport { ToolFallback } from \"@/components/assistant-ui/tool-fallback\";\nimport { TooltipIconButton } from \"@/components/assistant-ui/tooltip-icon-button\";\nimport {\n  ComposerAddAttachment,\n  ComposerAttachments,\n  UserMessageAttachments,\n} from \"@/components/assistant-ui/attachment\";\n\nimport { cn, useNotification, useThreadContext } from \"@aomi-labs/react\";\nimport { useAssistantApi, useMessage } from \"@assistant-ui/react\";\n\nconst seenSystemMessages = new Set<string>();\n\nexport const Thread: FC = () => {\n  const api = useAssistantApi();\n  const { threadViewKey } = useThreadContext();\n\n  useEffect(() => {\n    try {\n      const composer = api.composer();\n      composer.setText(\"\");\n      void composer.clearAttachments?.();\n    } catch (error) {\n      console.error(\"Failed to reset composer input:\", error);\n    }\n  }, [api, threadViewKey]);\n\n  return (\n    <LazyMotion features={domAnimation}>\n      <MotionConfig reducedMotion=\"user\">\n        <ThreadPrimitive.Root\n          className=\"aui-root aui-thread-root @container bg-background flex h-full flex-col\"\n          style={{\n            [\"--thread-max-width\" as string]: \"44rem\",\n          }}\n        >\n          <ThreadPrimitive.Viewport className=\"aui-thread-viewport relative flex flex-1 flex-col overflow-x-auto overflow-y-scroll px-4\">\n            <ThreadPrimitive.If empty>\n              <ThreadWelcome />\n            </ThreadPrimitive.If>\n\n            <ThreadPrimitive.Messages\n              components={{\n                UserMessage,\n                EditComposer,\n                AssistantMessage,\n                SystemMessage,\n              }}\n            />\n\n            <ThreadPrimitive.If empty={false}>\n              <div className=\"aui-thread-viewport-spacer min-h-8 grow\" />\n            </ThreadPrimitive.If>\n\n            <Composer />\n          </ThreadPrimitive.Viewport>\n        </ThreadPrimitive.Root>\n      </MotionConfig>\n    </LazyMotion>\n  );\n};\n\nconst ThreadScrollToBottom: FC = () => {\n  return (\n    <ThreadPrimitive.ScrollToBottom asChild>\n      <TooltipIconButton\n        tooltip=\"Scroll to bottom\"\n        variant=\"outline\"\n        className=\"aui-thread-scroll-to-bottom dark:bg-background dark:hover:bg-accent absolute -top-12 z-10 self-center rounded-full p-4 disabled:invisible\"\n      >\n        <ArrowDownIcon />\n      </TooltipIconButton>\n    </ThreadPrimitive.ScrollToBottom>\n  );\n};\n\nconst ThreadWelcome: FC = () => {\n  return (\n    <div className=\"aui-thread-welcome-root mx-auto my-auto flex w-full max-w-[var(--thread-max-width)] flex-grow flex-col\">\n      <div className=\"aui-thread-welcome-center flex w-full flex-grow flex-col items-center justify-center\">\n        <div className=\"aui-thread-welcome-message flex size-full flex-col justify-center px-8\">\n          <m.div\n            initial={{ opacity: 0, y: 10 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: 10 }}\n            className=\"aui-thread-welcome-message-motion-1 text-2xl font-semibold\"\n          >\n            Hello there!\n          </m.div>\n          <m.div\n            initial={{ opacity: 0, y: 10 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: 10 }}\n            transition={{ delay: 0.1 }}\n            className=\"aui-thread-welcome-message-motion-2 text-muted-foreground/65 text-2xl\"\n          >\n            How can I help you today?\n          </m.div>\n        </div>\n      </div>\n      <ThreadSuggestions />\n    </div>\n  );\n};\n\nconst ThreadSuggestions: FC = () => {\n  return (\n    <div className=\"aui-thread-welcome-suggestions @md:grid-cols-2 grid w-full gap-2 pb-4\">\n      {[\n        {\n          title: \"Show my wallet balances\",\n          label: \"and positions\",\n          action: \"Show my wallet balances and positions\",\n        },\n        {\n          title: \"Swap 1 ETH to USDC\",\n          label: \"with the best price\",\n          action: \"Swap 1 ETH to USDC with the best price\",\n        },\n        {\n          title: \"Stake half of my ETH\",\n          label: \"in the highest yield pool\",\n          action: \"Stake half of my ETH in the highest yield pool\",\n        },\n        {\n          title: \"Bridge 100 USDC\",\n          label: \"from Ethereum to Arbitrum\",\n          action: \"Bridge 100 USDC from Ethereum to Arbitrum\",\n        },\n      ].map((suggestedAction, index) => (\n        <m.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          exit={{ opacity: 0, y: 20 }}\n          transition={{ delay: 0.05 * index }}\n          key={`suggested-action-${suggestedAction.title}-${index}`}\n          className=\"aui-thread-welcome-suggestion-display @md:[&:nth-child(n+3)]:block [&:nth-child(n+3)]:hidden\"\n        >\n          <ThreadPrimitive.Suggestion\n            prompt={suggestedAction.action}\n            send\n            asChild\n          >\n            <Button\n              variant=\"ghost\"\n              className=\"aui-thread-welcome-suggestion @md:flex-col dark:hover:bg-accent/60 h-auto w-full flex-1 flex-wrap items-start justify-start gap-1 rounded-3xl border px-5 py-4 text-left text-sm\"\n              aria-label={suggestedAction.action}\n            >\n              <span className=\"aui-thread-welcome-suggestion-text-1 font-medium\">\n                {suggestedAction.title}\n              </span>\n              <span className=\"aui-thread-welcome-suggestion-text-2 text-muted-foreground\">\n                {suggestedAction.label}\n              </span>\n            </Button>\n          </ThreadPrimitive.Suggestion>\n        </m.div>\n      ))}\n    </div>\n  );\n};\n\nconst Composer: FC = () => {\n  return (\n    <div className=\"aui-composer-wrapper bg-background sticky bottom-0 mx-auto flex w-full max-w-[var(--thread-max-width)] flex-col gap-4 overflow-visible rounded-t-3xl pb-4 md:pb-6\">\n      <ThreadScrollToBottom />\n      <ComposerPrimitive.Root className=\"aui-composer-root rounded-4xl dark:border-muted-foreground/15 relative flex w-full flex-col border bg-white px-1 pt-2 shadow-[0_9px_9px_0px_rgba(0,0,0,0.01),0_2px_5px_0px_rgba(0,0,0,0.06)]\">\n        <ComposerAttachments />\n        <ComposerPrimitive.Input\n          placeholder=\"Send a message...\"\n          className=\"aui-composer-input placeholder:text-muted-foreground focus:outline-primary ml-3 mt-2 max-h-32 min-h-16 w-full resize-none bg-transparent px-3.5 pb-3 pt-1.5 text-sm text-stone-800 outline-none\"\n          rows={1}\n          autoFocus\n          aria-label=\"Message input\"\n        />\n        <ComposerAction />\n      </ComposerPrimitive.Root>\n    </div>\n  );\n};\n\nconst ComposerAction: FC = () => {\n  return (\n    <div className=\"aui-composer-action-wrapper relative mx-1 mb-2 mt-2 flex items-center justify-between\">\n      <ComposerAddAttachment />\n\n      <ThreadPrimitive.If running={false}>\n        <ComposerPrimitive.Send asChild>\n          <TooltipIconButton\n            tooltip=\"Send message\"\n            side=\"bottom\"\n            type=\"submit\"\n            variant=\"default\"\n            size=\"icon\"\n            className=\"aui-composer-send mb-3 mr-3 size-[34px] rounded-full p-1\"\n            aria-label=\"Send message\"\n          >\n            <ArrowUpIcon className=\"aui-composer-send-icon size-5\" />\n          </TooltipIconButton>\n        </ComposerPrimitive.Send>\n      </ThreadPrimitive.If>\n\n      <ThreadPrimitive.If running>\n        <ComposerPrimitive.Cancel asChild>\n          <Button\n            type=\"button\"\n            variant=\"default\"\n            size=\"icon\"\n            className=\"aui-composer-cancel border-muted-foreground/60 hover:bg-primary/75 dark:border-muted-foreground/90 size-[34px] rounded-full border\"\n            aria-label=\"Stop generating\"\n          >\n            <Square className=\"aui-composer-cancel-icon size-3.5 fill-white dark:fill-black\" />\n          </Button>\n        </ComposerPrimitive.Cancel>\n      </ThreadPrimitive.If>\n    </div>\n  );\n};\n\nconst MessageError: FC = () => {\n  return (\n    <MessagePrimitive.Error>\n      <ErrorPrimitive.Root className=\"aui-message-error-root border-destructive bg-destructive/10 text-destructive dark:bg-destructive/5 mt-2 rounded-md border p-3 text-sm dark:text-red-200\">\n        <ErrorPrimitive.Message className=\"aui-message-error-message line-clamp-2\" />\n      </ErrorPrimitive.Root>\n    </MessagePrimitive.Error>\n  );\n};\n\nconst AssistantMessage: FC = () => {\n  return (\n    <MessagePrimitive.Root asChild>\n      <div\n        className=\"aui-assistant-message-root animate-in fade-in slide-in-from-bottom-1 relative mx-auto w-full max-w-[var(--thread-max-width)] py-4 duration-150 ease-out last:mb-24\"\n        data-role=\"assistant\"\n      >\n        <div className=\"aui-assistant-message-content text-foreground mx-2 break-words text-sm leading-5\">\n          <MessagePrimitive.Parts\n            components={{\n              Text: MarkdownText,\n              tools: { Fallback: ToolFallback },\n            }}\n          />\n          <MessageError />\n        </div>\n\n        <div className=\"aui-assistant-message-footer ml-2 mt-2 flex\">\n          <BranchPicker />\n          <AssistantActionBar />\n        </div>\n      </div>\n    </MessagePrimitive.Root>\n  );\n};\n\nconst AssistantActionBar: FC = () => {\n  return (\n    <ActionBarPrimitive.Root\n      hideWhenRunning\n      autohide=\"not-last\"\n      autohideFloat=\"single-branch\"\n      className=\"aui-assistant-action-bar-root text-muted-foreground data-floating:absolute data-floating:rounded-md data-floating:border data-floating:bg-background data-floating:p-1 data-floating:shadow-sm col-start-3 row-start-2 -ml-1 flex gap-1\"\n    >\n      <ActionBarPrimitive.Copy asChild>\n        <TooltipIconButton tooltip=\"Copy\">\n          <MessagePrimitive.If copied>\n            <CheckIcon />\n          </MessagePrimitive.If>\n          <MessagePrimitive.If copied={false}>\n            <CopyIcon />\n          </MessagePrimitive.If>\n        </TooltipIconButton>\n      </ActionBarPrimitive.Copy>\n      <ActionBarPrimitive.Reload asChild>\n        <TooltipIconButton tooltip=\"Refresh\">\n          <RefreshCwIcon />\n        </TooltipIconButton>\n      </ActionBarPrimitive.Reload>\n    </ActionBarPrimitive.Root>\n  );\n};\n\nconst UserMessage: FC = () => {\n  return (\n    <MessagePrimitive.Root asChild>\n      <div\n        className=\"aui-user-message-root animate-in fade-in slide-in-from-bottom-1 mx-auto grid w-full max-w-[var(--thread-max-width)] auto-rows-auto grid-cols-[minmax(72px,1fr)_auto] gap-y-2 px-2 py-4 duration-150 ease-out first:mt-3 last:mb-5 [&:where(>*)]:col-start-2\"\n        data-role=\"user\"\n      >\n        <UserMessageAttachments />\n\n        <div className=\"aui-user-message-content-wrapper relative col-start-2 min-w-0\">\n          <div className=\"aui-user-message-content bg-muted text-foreground break-words rounded-3xl px-5 py-2.5 text-sm\">\n            <MessagePrimitive.Parts />\n          </div>\n          <div className=\"aui-user-action-bar-wrapper absolute left-0 top-1/2 -translate-x-full -translate-y-1/2 pr-2\">\n            <UserActionBar />\n          </div>\n        </div>\n\n        <BranchPicker className=\"aui-user-branch-picker col-span-full col-start-1 row-start-3 -mr-1 justify-end\" />\n      </div>\n    </MessagePrimitive.Root>\n  );\n};\n\nconst UserActionBar: FC = () => {\n  return (\n    <ActionBarPrimitive.Root\n      hideWhenRunning\n      autohide=\"not-last\"\n      className=\"aui-user-action-bar-root flex flex-col items-end\"\n    >\n      <ActionBarPrimitive.Edit asChild>\n        <TooltipIconButton tooltip=\"Edit\" className=\"aui-user-action-edit p-4\">\n          <PencilIcon />\n        </TooltipIconButton>\n      </ActionBarPrimitive.Edit>\n    </ActionBarPrimitive.Root>\n  );\n};\n\nconst EditComposer: FC = () => {\n  return (\n    <div className=\"aui-edit-composer-wrapper mx-auto flex w-full max-w-[var(--thread-max-width)] flex-col gap-4 px-2 first:mt-4\">\n      <ComposerPrimitive.Root className=\"aui-edit-composer-root max-w-7/8 bg-muted ml-auto flex w-full flex-col rounded-xl\">\n        <ComposerPrimitive.Input\n          className=\"aui-edit-composer-input text-foreground flex min-h-[60px] w-full resize-none bg-transparent p-4 outline-none\"\n          autoFocus\n        />\n\n        <div className=\"aui-edit-composer-footer mx-3 mb-3 flex items-center justify-center gap-2 self-end\">\n          <ComposerPrimitive.Cancel asChild>\n            <Button variant=\"ghost\" size=\"sm\" aria-label=\"Cancel edit\">\n              Cancel\n            </Button>\n          </ComposerPrimitive.Cancel>\n          <ComposerPrimitive.Send asChild>\n            <Button size=\"sm\" aria-label=\"Update message\">\n              Update\n            </Button>\n          </ComposerPrimitive.Send>\n        </div>\n      </ComposerPrimitive.Root>\n    </div>\n  );\n};\n\nconst BranchPicker: FC<BranchPickerPrimitive.Root.Props> = ({\n  className,\n  ...rest\n}) => {\n  return (\n    <BranchPickerPrimitive.Root\n      hideWhenSingleBranch\n      className={cn(\n        \"aui-branch-picker-root text-muted-foreground -ml-2 mr-2 inline-flex items-center text-xs\",\n        className,\n      )}\n      {...rest}\n    >\n      <BranchPickerPrimitive.Previous asChild>\n        <TooltipIconButton tooltip=\"Previous\">\n          <ChevronLeftIcon />\n        </TooltipIconButton>\n      </BranchPickerPrimitive.Previous>\n      <span className=\"aui-branch-picker-state font-medium\">\n        <BranchPickerPrimitive.Number /> / <BranchPickerPrimitive.Count />\n      </span>\n      <BranchPickerPrimitive.Next asChild>\n        <TooltipIconButton tooltip=\"Next\">\n          <ChevronRightIcon />\n        </TooltipIconButton>\n      </BranchPickerPrimitive.Next>\n    </BranchPickerPrimitive.Root>\n  );\n};\n\nconst SystemMessage: FC = () => {\n  const { showNotification } = useNotification();\n  const messageId = useMessage((state) => state.id);\n  const content = useMessage((state) => state.content) as Array<{\n    type: string;\n    text?: string;\n  }>;\n  const custom = useMessage((state) => state.metadata?.custom) as\n    | { kind?: string; title?: string }\n    | undefined;\n  useEffect(() => {\n    const text = content\n      .filter((part) => part.type === \"text\")\n      .map((part) => part.text ?? \"\")\n      .join(\"\")\n      .trim();\n\n    if (!text) return;\n\n    const key = messageId ?? text;\n    if (seenSystemMessages.has(key)) return;\n    seenSystemMessages.add(key);\n\n    const inferredKind =\n      custom?.kind ??\n      (text.startsWith(\"Wallet transaction request:\")\n        ? \"wallet_tx_request\"\n        : \"system_notice\");\n\n    const type =\n      inferredKind === \"system_error\"\n        ? \"error\"\n        : inferredKind === \"system_success\"\n          ? \"success\"\n          : \"notice\";\n\n    const title =\n      custom?.title ??\n      (inferredKind === \"wallet_tx_request\"\n        ? \"Wallet transaction request\"\n        : inferredKind === \"system_error\"\n          ? \"Error\"\n          : \"System notice\");\n\n    showNotification({ type, title, message: text });\n  }, [content, custom, showNotification, messageId]);\n\n  return null;\n};\n"
    }
  ],
  "dependencies": [
    "@aomi-labs/react",
    "@assistant-ui/react",
    "@assistant-ui/react-markdown",
    "lucide-react",
    "remark-gfm"
  ],
  "registryDependencies": [
    "https://r.assistant-ui.com/markdown-text.json",
    "https://r.assistant-ui.com/tooltip-icon-button.json",
    "https://r.assistant-ui.com/attachment.json",
    "https://widget.aomi.dev/r/assistant-tool-fallback.json",
    "button"
  ]
}